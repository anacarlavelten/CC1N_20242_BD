CREATE SCHEMA EST_CASO_III;

USE EST_CASO_III;

CREATE TABLE IF NOT EXISTS MAQUINAS(
MAQ_COD INT PRIMARY KEY,
MAQ_NOME VARCHAR (50),
MAQ_TEMP_VIDA VARCHAR (40),
MAQ_DATA_COMP DATE,
MAQ_DATA_FIM_GRT DATE
);

CREATE TABLE IF NOT EXISTS REGISTRO_MANUTENÇÃO(
RM_COD INT PRIMARY KEY,
RM_DATA DATE,
RM_DESC TEXT,
RM_MAQ INT,
CONSTRAINT RM_FK_MAQ FOREIGN KEY (RM_MAQ) REFERENCES MAQUINAS(MAQ_COD)
);

CREATE TABLE IF NOT EXISTS PRODUTOS (
PROD_COD INT PRIMARY KEY,
PROD_NOME VARCHAR (45),
PROD_DIMENSOES VARCHAR (45),
PROD_COR VARCHAR(50),
TEMP_FAB_PROD VARCHAR(45),
PROD_EST INT
);

CREATE TABLE IF NOT EXISTS MAQUINAS_PROD(
MAQUINAS_COD INT,
PRODUTOS_COD INT,
PRIMARY KEY (PRODUTOS_COD,MAQUINAS_COD),
TEMP_USO TIME,
CONSTRAINT MAQ_FK FOREIGN KEY (MAQUINAS_COD) REFERENCES MAQUINAS(MAQ_COD),
CONSTRAINT PROD_FK_MAQ FOREIGN KEY (PRODUTOS_COD) REFERENCES PRODUTOS(PROD_COD)
);

CREATE TABLE IF NOT EXISTS CARGOS (
CARGO_ID INT PRIMARY KEY,
CARGO_NOME VARCHAR(45),
CARGO_FUNÇÃO VARCHAR(45),
CARGO_SALARIO DECIMAL (10,3)
);

CREATE TABLE IF NOT EXISTS TIPO_COMPONENTE(
TICP_ID INT PRIMARY KEY,
TICP_NOME VARCHAR(45),
TICP_QNT DECIMAL (10,3)
);

CREATE TABLE IF NOT EXISTS TIPO_ENDEREÇO (
TIEN_ID INT PRIMARY KEY,
TIEN_NOME VARCHAR (45)
);

CREATE TABLE IF NOT EXISTS ENDEREÇOS (
END_ID INT PRIMARY KEY,
END_RUA VARCHAR(45),
END_BAIRRO VARCHAR(45),
END_NUMRUA VARCHAR(45),
END_UF VARCHAR(45),
END_CIDADE VARCHAR(45),
END_PAIS VARCHAR(45),
END_CEP VARCHAR(45),
END_TIPO INT,
CONSTRAINT END_FK_TIPO FOREIGN KEY (END_TIPO) REFERENCES TIPO_ENDEREÇO(TIEN_ID)
);

CREATE TABLE IF NOT EXISTS EMPRESAS(
EMP_CNPJ VARCHAR (30),
EMP_RAZAOSOCIAL VARCHAR (45),
EMP_ATIVIDADE TEXT,
EMP_NOME VARCHAR (50),
EMP_CONTATO VARCHAR(50),
EMP_ENDEREÇO INT,
CONSTRAINT EMP_FK_END FOREIGN KEY (EMP_ENDEREÇO) REFERENCES ENDEREÇOS (END_ID)
);

CREATE TABLE IF NOT EXISTS TELEFONE_EMP(
TEL_COD INT PRIMARY KEY,
TEL_NUM VARCHAR(30),
TEL_EMP VARCHAR(30),
CONSTRAINT EMP_FK_TEL FOREIGN KEY (TEL_EMP) REFERENCES EMPRESAS (EMP_CNPJ)
);

CREATE TABLE IF NOT EXISTS CLIENTES(
CLI_ID INT PRIMARY KEY,
CLI_DATACAD DATE,
CLI_CONT VARCHAR(11),
CLI_NOME VARCHAR(100),
CLI_EMP INT,
CONSTRAINT CLI_FK_EMP FOREIGN KEY (CLI_EMP) REFERENCES EMPRESAS (EMP_CNPJ)
);

CREATE TABLE IF NOT EXISTS ENCOMENDAS(
ENC_COD INT PRIMARY KEY,
ENC_DATA DATE,
ENC_CLI INT,
CONSTRAINT EN_FK_CLIENTE FOREIGN KEY (ENC_CLI) REFERENCES CLIENTES(CLI_ID)
);

CREATE TABLE IF NOT EXISTS PAGAMENTOS(
PAG_ID INT PRIMARY KEY,
PAG_TOTAL DECIMAL(10,3),
PAG_DESC DECIMAL(10,3),
PAG_DATA DATE NOT NULL,
PAG_PARCELAS INT,
PAG_ENC INT,
CONSTRAINT PAG_FK_ENCOMENDAS FOREIGN KEY (PAG_ENC) REFERENCES ENCOMENDAS(ENC_COD)
);

CREATE TABLE IF NOT EXISTS ENDEREÇO_CLIENTE (
ENDC_ID INT PRIMARY KEY,
ENDC_RUA VARCHAR(45),
ENDC_BAIRRO VARCHAR(45),
ENDC_NUMRUA VARCHAR(45),
ENDC_UF VARCHAR(45),
ENDC_CIDADE VARCHAR(45),
ENDC_PAIS VARCHAR(45),
ENDC_CEP VARCHAR(45),
ENDC_TIPO INT,
ENDC_CLI INT,
CONSTRAINT END_FK_TIPO FOREIGN KEY (ENDC_TIPO) REFERENCES TIPO_ENDEREÇO(TIEN_ID),
CONSTRAINT END_FK_CLI FOREIGN KEY (END_CLI) REFERENCES CLIENTES(CLI_ID)
);

CREATE TABLE IF NOT EXISTS EMPREGADOS(
EMP_MATRICULA INT PRIMARY KEY,
EMP_NOME VARCHAR(100),
EMP_CPF VARCHAR(30),
EMP_ADIM DATE,
EMP_QUAL VARCHAR (45),
EMP_CARGO INT,
EMP_ENDEREÇO INT,
CONSTRAINT EMP_FK_CAR FOREIGN KEY (EMP_CARGO) REFERENCES CARGOS (CARGO_ID),
CONSTRAINT EMP_FK_ENDEREÇO FOREIGN KEY (EMP_ENDEREÇO) REFERENCES ENDEREÇOS (END_ID)
);

CREATE TABLE IF NOT EXISTS PRODUTOS_ENCOMENDAS(
PDEN_PROD_COD INT,
PDEN_ENC_COD INT,
PRIMARY KEY (PDEN_PROD_COD,PDEN_ENC_COD),
PDEN_QUANT DECIMAL (10,3),
CONSTRAINT PROD_FK FOREIGN KEY (PDEN_PROD_COD) REFERENCES PRODUTOS(PROD_COD),
CONSTRAINT ENC_FK FOREIGN KEY (PDEN_ENC_COD) REFERENCES ENCOMENDAS (ENC_COD)
);

CREATE TABLE IF NOT EXISTS PRODUTOS_EMPREGADOS (
EMPREGADO_COD INT,
PRODUTO_ID INT,
PRIMARY KEY (EMPREGADO_COD,PRODUTO_ID),
PREM_HORAS TIME,
CONSTRAINT EMP_FK_PROD FOREIGN KEY (EMPREGADO_COD) REFERENCES EMPREGADOS (EMP_MATRICULA),
CONSTRAINT PROD_FK_EMP FOREIGN KEY (PRODUTO_ID) REFERENCES PRODUTOS (PROD_COD)
);

CREATE TABLE IF NOT EXISTS RECURSOS_ESPEC(
REC_PROD INT PRIMARY KEY,
REC_QTS INT, 
REC_UND VARCHAR (45),
REC_HORAS TIME,
CONSTRAINT PROD_FK_REC FOREIGN KEY (REC_PROD) REFERENCES PRODUTOS (PROD_COD)
);

CREATE TABLE IF NOT EXISTS COMPONENTES(
COMP_ID INT PRIMARY KEY,
COMP_NOME VARCHAR(50),
COMP_UNIDADE VARCHAR (50),
COMP_ESTOQUE VARCHAR (45),
COMP_TIPO INT,
CONSTRAINT COMP_TIP FOREIGN KEY (COMP_TIPO) REFERENCES TIPO_COMPONENTE (TICP_ID)
);

CREATE TABLE IF NOT EXISTS PRODUTOS_COMPONENTES (
PRCOM_PRODUTOS INT,
PRCOM_COMPONENTE INT,
PRIMARY KEY (PRCOM_PRODUTOS,PRCOM_COMPONENTE),
CONSTRAINT PROCOM_FK FOREIGN KEY (PRCOM_PRODUTOS) REFERENCES PRODUTOS (PROD_COD),
CONSTRAINT COMPR_FK FOREIGN KEY (PRCOM_COMPONENTE) REFERENCES COMPONENTES(COMP_ID)
);

CREATE TABLE IF NOT EXISTS FORNECEDORES(
FORN_ID INT PRIMARY KEY,
FORN_PESSO VARCHAR(45),
FORN_NMR_CONT VARCHAR(40),
FORN_EMP INT,
CONSTRAINT FORN_FK_EMP FOREIGN KEY (FORN_EMP) REFERENCES EMPRESAS (EMP_CNPJ)
);

CREATE TABLE IF NOT EXISTS COMPONENTES_FORNECEDORES(
COMPFR_COD INT,
FRCOD_CO INT,
PRIMARY KEY (COMPFR_COD,FRCOD_CO),
COFR_PREÇO DECIMAL (10,3),
CONSTRAINT COMP_FK_COD FOREIGN KEY (COMPFR_COD) REFERENCES COMPONENTES(COMP_ID),
CONSTRAINT FORN_FK_COD FOREIGN KEY (FRCOD_CO) REFERENCES FORNECEDORES(FORN_ID)
);

CREATE TABLE IF NOT EXISTS REGISTRO_RESSUPRIMENTO(
REG_COD INT PRIMARY KEY,
REG_DATA DATE,
REG_QNT_NECES DECIMAL(8,3),
REG_COMP INT,
REG_FORN INT, 
CONSTRAINT COMP_FK_REGISTRO FOREIGN KEY (REG_COMP) REFERENCES COMPONENTES(COMP_ID),
CONSTRAINT FORN_FK_REGISTRO FOREIGN KEY (REG_FORN) REFERENCES FORNECEDORES(FORN_ID)
);

CREATE TABLE IF NOT EXISTS TELEFONE_EMPREGADO(
TLEM_COD INT PRIMARY KEY,
TLEM_NUM VARCHAR(30),
TLEM_EMPREGADO VARCHAR(30),
CONSTRAINT TEL_FK_EMP FOREIGN KEY (TLEM_EMPREGADO) REFERENCES EMPREGADOS (EMP_MATRICULA)
);

CREATE TABLE IF NOT EXISTS RECURSOS_RH(
RECURSOS_ID INT PRIMARY KEY,
RH_QTD_EMP DECIMAL (10,0),
RH_FOLHADEPAG DECIMAL(10,3)
);
